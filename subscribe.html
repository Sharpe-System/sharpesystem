<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Subscribe — SharpeSystem</title>
  <meta name="description" content="Subscription." />
  <link rel="stylesheet" href="/styles.css" />
</head>

<body class="shell">
  <div id="site-header"></div>

  <main class="page">
    <div class="container content">

      <section class="template-box">
        <h1>Subscribe</h1>
        <p class="muted">Choose a plan to unlock paid features.</p>

        <!-- VALUE EXPLANATION -->
        <div class="card" style="margin-top:16px;padding:18px;border-radius:18px;background:#f8fafc;">
          <h2 style="margin-top:0;">Why this is worth paying for</h2>

          <p style="font-size:15px;line-height:1.5;">
            You are paying for court documents that come out correctly formatted and ready to file.
            No guesswork. No confusing forms. No rejected paperwork.
          </p>

          <p style="font-size:15px;line-height:1.5;">
            You explain what happened in your own words.
            SharpeSystem helps write it clearly in the language judges expect.
          </p>

          <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:14px;">
            <div style="padding:14px;border-radius:16px;background:#eef2ff;">
              <strong>Basic</strong>
              <ul style="margin:8px 0 0 18px;">
                <li>One perfect court document</li>
                <li>Step-by-step guidance</li>
                <li>Clear court wording help</li>
                <li>Ready-to-file download</li>
              </ul>
            </div>

            <div style="padding:14px;border-radius:16px;background:#ecfeff;">
              <strong>Pro</strong>
              <ul style="margin:8px 0 0 18px;">
                <li>Unlimited documents</li>
                <li>Ongoing drafting help</li>
                <li>Stronger court wording tools</li>
                <li>All future upgrades</li>
              </ul>
            </div>
          </div>
        </div>

        <!-- TIER BUTTONS -->
        <div class="cta-row" style="margin-top:18px;display:flex;gap:12px;flex-wrap:wrap;">
          <button id="payBasic" style="padding:14px 18px;border-radius:18px;font-size:16px;background:#6366f1;color:#fff;border:0;">
            Subscribe Basic
          </button>

          <button id="payPro" style="padding:14px 18px;border-radius:18px;font-size:16px;background:#06b6d4;color:#fff;border:0;">
            Subscribe Pro
          </button>
        </div>

        <p id="msg" class="muted" style="margin-top:12px;"></p>

        <div class="cta-row" style="margin-top:14px;">
          <a class="button" href="/pricing.html">Plans</a>
          <a class="button" href="/billing.html">Billing</a>
          <a class="button" href="/">Home</a>
        </div>

      </section>

    </div>
  </main>

  <script src="/ui.js"></script>
  <script src="/header-loader.js"></script>
  <script src="/partials/header.js"></script>
  <script src="/i18n.js"></script>

  <script type="module">
    import { getAuthStateOnce } from "/firebase-config.js";

    const WORKER_BASE = "https://sharpe-pay.nd-sharpe.workers.dev";
    const msg = document.getElementById("msg");

    function setMsg(t){ if (msg) msg.textContent = t || ""; }

    async function startCheckout(tier) {
      try {
        setMsg("Creating checkout…");

        const state = await getAuthStateOnce();
        const user = state?.user || null;

        const r = await fetch(`${WORKER_BASE}/create-checkout`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            tier,
            firebaseUid: user?.uid || null,
            email: user?.email || null
          })
        });

        const data = await r.json().catch(() => ({}));
        if (!r.ok || !data.checkoutUrl) {
          console.log("Checkout error:", data);
          setMsg("Checkout failed.");
          return;
        }

        window.location.href = data.checkoutUrl;
      } catch (e) {
        console.log(e);
        setMsg("Network error.");
      }
    }

    document.getElementById("payBasic").addEventListener("click", () => startCheckout("basic"));
    document.getElementById("payPro").addEventListener("click", () => startCheckout("pro"));
  </script>

  <script type="module" src="/gate.js"></script>
</body>
</html>
